<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<!-- // <script src="http://code.jquery.com/jquery-latest.js"></script> -->
	<script type="text/javascript" src="../jquery-2.1.4.js"></script>
	<script type="text/javascript">

		function Task() {
			var callbacks = [];
			return {
				resolve: function(_value) {
					for (var i = 0, ii = callbacks.length; i < ii; i++) {
						 var callback = callbacks[i];
						callback(_value);
					}
				},
				then: function(callback) {
					callbacks.push(callback);
				}
			}
		};
						
		// var t = Task();

		// t.then(function(value) {
		// 	// alert(value) //结果是 1000
		// })

		// setTimeout(function(){
		// 	t.resolve(1000)
		// },1000)




		function Task() {
			var callbacks = [],
				pending = 'unfulfilled',
				_value;
			return {
				resolve: function(value) {
					for (var i = 0, ii = callbacks.length; i < ii; i++) {
						 var callback = callbacks[i];
						callback(value);
					}
					_value = value
					pending = 'fulfilled'
					callbacks = undefined;
				},
				then: function(callback) {
		            if (pending == 'unfulfilled') {
		                callbacks.push(callback);
		            } else {
		                callback(_value);
		            }
				}
			}
		};
						
		var t = Task();

		t.resolve(1000)

		t.then(function(value) {
			alert(value) //结果是 1000
		})



	</script>
</head>
<body>

</body>
</html>